# Directum — Proyecto completo (Archivos)

Este documento contiene **todos los archivos** listos para subir a GitHub (o ejecutar en local). He incluido: `index.html`, `style.css`, `script.js`, `server.js` (proxy recomendado), y `README.md`. Abre el archivo y copia cada sección a su respectivo archivo en tu repo.

---

## 1) README.md

```
# Directum

Directum es una web educativa sobre trámites de grados y títulos en Ecuador. Incluye un chatbot integrado que puede conectarse a la API de OpenAI para responder preguntas sobre procesos de bachillerato y educación superior.

## Estructura del repo

- index.html         -> Interfaz de usuario (HTML)
- style.css          -> Estilos
- script.js          -> Lógica del frontend (chat, UI, interacción)
- server.js          -> (Opcional) proxy Node/Express para manejar la API Key de OpenAI de forma segura
- LICENSE
- README.md

## Cómo usar

### Opción A — Desarrollo local con proxy (recomendado)
1. Clona el repo.
2. Copia `server.example.env` a `.env` y añade `OPENAI_API_KEY=tu_api_key_aqui`.
3. Ejecuta `npm install` y luego `node server.js`.
4. Abre `index.html` en tu navegador y el chat enviará peticiones a `http://localhost:3000/api/chat`.

### Opción B — Usar directamente en cliente (NO recomendado para producción)
- Puedes pegar tu `OPENAI_API_KEY` en la caja que aparece en la interfaz para pruebas rápidas. Ten en cuenta que exponer la clave en el navegador es inseguro.

## Notas
- Actualiza los enlaces oficiales en `script.js` (const `FUENTES_OFICIALES`).
- Personaliza el logo SVG en `index.html` si lo deseas.
```

---

## 2) index.html

```html
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Directum — Guía de Grados (Ecuador)</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <!-- Logo SVG integrado -->
      <svg id="logo" width="56" height="56" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <rect rx="18" width="100" height="100" fill="#0f172a"></rect>
        <g transform="translate(16,18) scale(0.7)" fill="#fff">
          <path d="M10 5 L30 5 L40 20 L30 35 L10 35 L0 20 Z" fill="#60a5fa"></path>
          <text x="50" y="28" font-family="Arial, sans-serif" font-size="28" fill="#fff" font-weight="700">D</text>
        </g>
      </svg>
      <div class="brand-text">
        <h1>Directum</h1>
        <p class="tag">Conoce tus derechos — Trámites de grados</p>
      </div>
    </div>
    <div class="top-actions">
      <button id="btnSources" class="btn ghost">Fuentes</button>
      <button id="btnApiKey" class="btn ghost">Configurar API Key</button>
    </div>
  </header>

  <main class="container">
    <aside class="left">
      <section class="card">
        <h2>Buscar FAQ</h2>
        <input id="search" placeholder="Ej: ¿Cómo registro mi título?" />
      </section>

      <section class="card">
        <h2>Simular expediente</h2>
        <select id="tipoTitulo">
          <option value="bachiller">Bachillerato</option>
          <option value="nacional">Título nacional</option>
          <option value="extranjero">Título extranjero</option>
        </select>
        <input id="institucion" placeholder="Institución (opcional)" />
        <div class="row">
          <button id="simularBtn" class="btn primary">Generar checklist</button>
          <button id="descargarPlantillaBtn" class="btn">Plantilla</button>
        </div>
      </section>

      <section class="card small">
        <h3>Advertencias</h3>
        <ul>
          <li>No uses intermediarios no oficiales.</li>
          <li>Verifica enlaces oficiales antes de pagar.</li>
          <li>Conserva comprobantes y copias.</li>
        </ul>
      </section>

      <section class="card small">
        <h3>Línea de tiempo</h3>
        <div class="timeline">
          <div class="step"><strong>Solicitud</strong><span>1-2 semanas</span></div>
          <div class="step"><strong>Validación</strong><span>2-6 semanas</span></div>
          <div class="step"><strong>Entrega</strong><span>1-2 semanas</span></div>
        </div>
      </section>
    </aside>

    <section class="main">
      <div class="card">
        <h2>Preguntas frecuentes</h2>
        <div id="faqList"></div>
      </div>

      <div class="card chat-panel">
        <div class="chat-header">
          <h3>Chatbot Directum</h3>
          <div class="chat-meta">Tono: claro · Fuentes oficiales</div>
        </div>
        <div id="messages" class="messages"></div>

        <div class="chat-controls">
          <textarea id="prompt" placeholder="Escribe tu pregunta sobre grados... (p. ej.: ¿Qué documentos necesito para registrar mi título?)"></textarea>
          <div class="row">
            <button id="send" class="btn primary">Enviar</button>
            <button id="exampleBtn" class="btn ghost">Ejemplo</button>
          </div>
        </div>
      </div>

    </section>
  </main>

  <footer class="footer">
    <div>Directum — Proyecto educativo. Actualiza las fuentes oficiales en la configuración.</div>
  </footer>

  <div id="modalApiKey" class="modal hidden">
    <div class="modal-content">
      <h3>Configurar API Key (solo para pruebas)</h3>
      <p>Se recomienda usar un proxy (server.js). Si usas la clave en el navegador, será visible.</p>
      <input id="apiKeyInput" placeholder="sk-..." />
      <div class="row">
        <button id="saveKey" class="btn primary">Guardar</button>
        <button id="closeKey" class="btn ghost">Cerrar</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
```

---

## 3) style.css

```css
:root{
  --bg:#0f172a; /* dark navy */
  --accent:#2563eb; /* blue */
  --muted:#6b7280;
  --card:#ffffff;
}
*{box-sizing:border-box}
body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:#f3f4f6; color:#0f172a; margin:0}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:16px 24px;background:linear-gradient(90deg,#0b1220 0%, #0f172a 100%);color:#fff}
.brand{display:flex;align-items:center;gap:12px}
.brand-text h1{margin:0;font-size:20px}
.brand-text p{margin:0;font-size:12px;color:rgba(255,255,255,0.85)}
.container{display:grid;grid-template-columns:280px 1fr;gap:20px;padding:24px;max-width:1100px;margin:24px auto}
.left{display:flex;flex-direction:column;gap:12px}
.card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(15,23,42,0.06)}
.small{font-size:14px}
.row{display:flex;gap:8px}
.btn{padding:8px 12px;border-radius:8px;border:1px solid rgba(15,23,42,0.06);background:#fff;cursor:pointer}
.btn.primary{background:var(--accent);color:#fff;border:none}
.btn.ghost{background:transparent;color:#fff;border:1px solid rgba(255,255,255,0.08)}
.left input, .left select{width:100%;padding:10px;border-radius:8px;border:1px solid #e5e7eb}
.main{display:flex;flex-direction:column;gap:12px}
.chat-panel{display:flex;flex-direction:column;height:520px}
.chat-header{display:flex;align-items:center;justify-content:space-between}
.messages{flex:1;overflow:auto;padding:12px;border-radius:8px;background:#f8fafc;margin-top:12px}
.message{max-width:80%;padding:10px;border-radius:10px;margin-bottom:10px}
.message.user{background:#e0f2fe;align-self:flex-end}
.message.bot{background:#eef2ff;align-self:flex-start}
.chat-controls{margin-top:12px}
.chat-controls textarea{width:100%;height:80px;padding:10px;border-radius:8px;border:1px solid #e5e7eb}
.footer{padding:16px;text-align:center;color:var(--muted)}
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(15,23,42,0.5)}
.modal.hidden{display:none}
.modal-content{background:#fff;padding:20px;border-radius:12px;min-width:320px}
.timeline{display:flex;flex-direction:column;gap:8px}
.timeline .step{display:flex;justify-content:space-between;background:#f8fafc;padding:8px;border-radius:8px}
@media (max-width:900px){.container{grid-template-columns:1fr;padding:12px}.left{order:2}.main{order:1}}
```

---

## 4) script.js

```javascript
/* script.js — Lógica de la UI y del chatbot */

// Fuentes oficiales (actualízalas)
const FUENTES_OFICIALES = [
  {nombre: 'Ministerio de Educación', url: 'https://educacion.gob.ec'},
  {nombre: 'SENESCYT', url: 'https://www.gob.ec/senescyt'},
  {nombre: 'Consejo de Educación Superior', url: 'https://www.ces.gob.ec'}
];

// FAQ iniciales
const FAQS = [
  {categoria:'Bachillerato', pregunta:'¿Cómo obtengo mi título de bachiller?', respuesta:'Solicita constancia de notas en tu institución, presenta la documentación en la Dirección Distrital, paga tasas si aplica y recoge el título.'},
  {categoria:'Educación Superior', pregunta:'¿Cómo registro un título universitario nacional?', respuesta:'Reúne copia del título y acta de grado y solicita el registro en la Secretaría de tu institución. Regístralo en SENESCYT si corresponde.'},
  {categoria:'Educación Superior', pregunta:'¿Cómo convalidar un título extranjero?', respuesta:'Apostilla/legaliza el título en el país de origen, tradúcelo oficialmente si es necesario y presenta la solicitud de convalidación ante SENESCYT u organismo competente.'}
];

// ---- UI Elements ----
const faqList = document.getElementById('faqList');
const search = document.getElementById('search');
const messages = document.getElementById('messages');
const promptInput = document.getElementById('prompt');
const sendBtn = document.getElementById('send');
const exampleBtn = document.getElementById('exampleBtn');
const btnApiKey = document.getElementById('btnApiKey');
const modalApiKey = document.getElementById('modalApiKey');
const apiKeyInput = document.getElementById('apiKeyInput');
const saveKey = document.getElementById('saveKey');
const closeKey = document.getElementById('closeKey');

// Render FAQ
function renderFaqs(list){
  faqList.innerHTML = '';
  list.forEach((f, i)=>{
    const el = document.createElement('div'); el.className = 'faq-item';
    el.innerHTML = `<strong>${f.categoria}</strong><div>${f.pregunta}</div><button data-i='${i}' class='btn'>Ver</button>`;
    faqList.appendChild(el);
  });
}
renderFaqs(FAQS);

faqList.addEventListener('click', (e)=>{
  const b = e.target.closest('button'); if(!b) return;
  const i = Number(b.dataset.i); const f = FAQS[i]; pushBotMessage(f.respuesta);
});

// Buscador
search.addEventListener('input', ()=>{
  const q = search.value.trim().toLowerCase();
  if(!q){ renderFaqs(FAQS); return; }
  renderFaqs(FAQS.filter(f=> (f.pregunta+f.respuesta+f.categoria).toLowerCase().includes(q)));
});

// Chat helpers
function pushUserMessage(text){
  const div = document.createElement('div'); div.className='message user'; div.textContent=text; messages.appendChild(div); messages.scrollTop = messages.scrollHeight;
}
function pushBotMessage(text){
  const div = document.createElement('div'); div.className='message bot'; div.textContent=text; messages.appendChild(div); messages.scrollTop = messages.scrollHeight;
}

// API Key handling (for quick tests only)
function getStoredKey(){ return localStorage.getItem('OPENAI_KEY') }
function setStoredKey(k){ localStorage.setItem('OPENAI_KEY', k) }

btnApiKey.addEventListener('click', ()=>{ modalApiKey.classList.remove('hidden'); apiKeyInput.value = getStoredKey() || ''; });
closeKey.addEventListener('click', ()=>{ modalApiKey.classList.add('hidden'); });
saveKey.addEventListener('click', ()=>{ setStoredKey(apiKeyInput.value.trim()); modalApiKey.classList.add('hidden'); alert('Clave guardada localmente (solo para pruebas).'); });

// Send to OpenAI (via proxy recommended)
async function queryOpenAI(message){
  const proxyUrl = '/api/chat'; // si usas server.js
  const localKey = getStoredKey();
  if(localKey){
    // Envío directo al endpoint de OpenAI (no recomendado en producción)
    const payload = {
      model: 'gpt-4o-mini',
      messages: [
        {role:'system', content:'Eres un asistente experto en trámites educativos de Ecuador. Responde en español, paso a paso, con tono claro y menciona fuentes oficiales.'},
        {role:'user', content: message}
      ],
      temperature:0.1,
      max_tokens:800
    };
    const res = await fetch('https://api.openai.com/v1/chat/completions',{ method:'POST', headers:{ 'Content-Type':'application/json', 'Authorization': 'Bearer '+localKey }, body:JSON.stringify(payload) });
    if(!res.ok) throw new Error('Error en la API: '+res.status);
    const data = await res.json();
    const text = data.choices?.[0]?.message?.content || 'Sin respuesta';
    return text;
  } else {
    // Usa proxy
    const res = await fetch(proxyUrl, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({message})});
    if(!res.ok){ throw new Error('Error en proxy: '+res.statusText); }
    const j = await res.json();
    return j.text;
  }
}

sendBtn.addEventListener('click', async ()=>{
  const text = promptInput.value.trim(); if(!text) return;
  pushUserMessage(text); promptInput.value = '';
  pushBotMessage('Pensando...');
  try{
    const ans = await queryOpenAI(text);
    // reemplazamos el último mensaje 'Pensando...'
    const bots = messages.querySelectorAll('.message.bot');
    bots[bots.length-1].textContent = ans;
  }catch(err){
    const bots = messages.querySelectorAll('.message.bot');
    bots[bots.length-1].textContent = 'Error: '+err.message;
  }
});

exampleBtn.addEventListener('click', ()=>{ promptInput.value = '¿Qué documentos necesito para registrar un título universitario obtenido en Ecuador?'; });

// Simulación de checklist
document.getElementById('simularBtn').addEventListener('click', ()=>{
  const tipo = document.getElementById('tipoTitulo').value;
  let texto = '';
  if(tipo==='bachiller') texto = '- Copia de cédula\n- Certificado de notas\n- Solicitud a Dirección Distrital\n- Pago de tasa (si aplica)';
  if(tipo==='nacional') texto = '- Copia de título y acta de grado\n- Cédula\n- Plan de estudios (si aplica)\n- Solicitud a Secretaría de la institución';
  if(tipo==='extranjero') texto = '- Título legalizado/apostillado\n- Traducción oficial si aplica\n- Plan de estudios y certificaciones\n- Solicitud de convalidación';
  pushBotMessage(texto);
});

// Descargar plantilla
document.getElementById('descargarPlantillaBtn').addEventListener('click', ()=>{
  const plantilla = `Ciudad, fecha\n\nSeñores: [Nombre de la institución]\nAsunto: Solicitud de trámite de título/grado\n\nYo, [Nombre completo], con identificación [número], solicito iniciar el trámite para la emisión/registro de mi título de [título].\n\nAtentamente,\n[Firma]`;
  const blob = new Blob([plantilla], {type:'text/plain'}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='plantilla_solicitud.txt'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
});

// Mostrar Fuentes
document.getElementById('btnSources').addEventListener('click', ()=>{
  const s = FUENTES_OFICIALES.map(f=>`- ${f.nombre}: ${f.url}`).join('\n'); alert('Fuentes oficiales:\n\n'+s);
});

// Init: welcome message
pushBotMessage('Hola — soy Directum. Pregúntame sobre el proceso de grados (bachillerato, registro de títulos, convalidaciones).');

```

---

## 5) server.js (proxy recomendado)

```javascript
// server.js - ejemplo de proxy con Express. Recomendado para no exponer la API Key en el navegador.

const express = require('express');
const fetch = require('node-fetch');
require('dotenv').config();
const app = express();
app.use(express.json());

const OPENAI_KEY = process.env.OPENAI_API_KEY;
if(!OPENAI_KEY) console.warn('No se encontró OPENAI_API_KEY en .env');

app.post('/api/chat', async (req, res) =>{
  try{
    const userMessage = req.body.message || '';
    const payload = {
      model: 'gpt-4o-mini',
      messages: [
        {role:'system', content:'Eres un asistente experto en trámites educativos de Ecuador. Responde en español, paso a paso.'},
        {role:'user', content: userMessage}
      ],
      temperature:0.1,
    };
    const r = await fetch('https://api.openai.com/v1/chat/completions', {
      method:'POST', headers:{'Content-Type':'application/json','Authorization':`Bearer ${OPENAI_KEY}`}, body: JSON.stringify(payload)
    });
    const j = await r.json();
    const text = j.choices?.[0]?.message?.content || '';
    res.json({text});
  }catch(e){ res.status(500).json({error: e.message}); }
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, ()=> console.log('Proxy corriendo en http://localhost:'+PORT));
```

---

## 6) server.example.env

```
# Copia este archivo a .env y agrega tu clave
OPENAI_API_KEY=sk-...
```

---

### ¿Qué hice ahora?
- He colocado todos los archivos del proyecto dentro de este documento para que los copies fácilmente a tu repositorio en GitHub.

### Próximos pasos sugeridos (rápidos):
1. Revisa `script.js` y actualiza `FUENTES_OFICIALES` con URLs reales si deseas.
2. Si vas a usar la API de OpenAI en producción, despliega `server.js` en un servidor (Heroku, Railway, Render) y almacena la clave en variables de entorno.
3. Si quieres, puedo crear un ZIP con todos los archivos o preparar el repo listo para subir a GitHub (commits, README mejorado, licencia).

Si quieres que suba esto en un ZIP o que lo publique directamente en un repo (te doy el contenido para copiar), dime y lo preparo.
